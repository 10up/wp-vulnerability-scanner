Feature: Show vulnerability status for plugins

  Scenario: Get status
    Given a WP install

    When I run `wp vuln plugin-status`
    Then STDOUT should contain:
      """
      Nothing to update
      """

  Scenario: Show vulnerable plugin
    Given a WP install

    When I run `wp plugin install relevant --version=1.0.2 --force`
    Then STDOUT should not be empty

    When I run `wp vuln plugin-status --no-color`
    Then STDOUT should be a table containing rows:
      | name     | installed version | status                                                 | fix            |
      | relevant | 1.0.2             | Relevant Related Posts <= 1.0.7 - Cross Site Scripting | Fixed in 1.0.8 |

    When I run `wp vuln plugin-status --porcelain`
    Then STDOUT should be:
      """
      relevant
      """
